(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31088,        590]
NotebookOptionsPosition[     29003,        548]
NotebookOutlinePosition[     29469,        565]
CellTagsIndexPosition[     29426,        562]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Force Field X with Mathematica", "Chapter",
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796319720247898*^9, 3.7963198883481913`*^9}, {
   3.7963201658100977`*^9, 3.796320195550817*^9}, {3.7963204706720037`*^9, 
   3.796320509099841*^9}, {3.796320556780018*^9, 3.796320559097172*^9}, 
   3.796320654025756*^9, {3.796322291309527*^9, 3.796322300154826*^9}, {
   3.796557763169304*^9, 3.79655776411285*^9}, {3.796557804727416*^9, 
   3.796557844423911*^9}, {3.796558050793521*^9, 3.7965581908898287`*^9}, 
   3.796558397846035*^9, {3.796563398441401*^9, 3.7965634189391317`*^9}, {
   3.79656385288803*^9, 3.796563904260149*^9}, 3.796564022316124*^9, {
   3.796634933060278*^9, 3.7966349476405773`*^9}, {3.7966349937518177`*^9, 
   3.7966350041399393`*^9}, 3.796635152689011*^9, {3.796635232657337*^9, 
   3.796635234120371*^9}, {3.796635362892253*^9, 3.796635371059825*^9}, {
   3.796635743403186*^9, 3.7966357601884623`*^9}, {3.796635813897436*^9, 
   3.796635819814723*^9}, 3.796639206817993*^9, {3.7967345464585133`*^9, 
   3.796734611487812*^9}, {3.796734660695097*^9, 3.796734664552396*^9}, {
   3.7968295764383173`*^9, 3.796829683835902*^9}, {3.796829713845192*^9, 
   3.796829858258731*^9}, {3.7968326441445312`*^9, 3.796832666488864*^9}, {
   3.796833059662339*^9, 3.796833067228063*^9}, {3.7968336728050003`*^9, 
   3.796833677282938*^9}, {3.796835133747052*^9, 3.796835134865658*^9}, {
   3.796835167023349*^9, 3.796835228003174*^9}, {3.796835285222909*^9, 
   3.796835287492798*^9}, {3.796840341736862*^9, 
   3.796840348621229*^9}},ExpressionUUID->"e93404f3-2eba-4454-ba93-\
e147654674f6"],

Cell[TextData[StyleBox["1. Prerequisites: Install Java and Add FFX to the \
Classpath",
 FontColor->GrayLevel[0]]], "Section",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796319720247898*^9, 3.7963198883481913`*^9}, {
   3.7963201658100977`*^9, 3.796320195550817*^9}, {3.7963204706720037`*^9, 
   3.796320509099841*^9}, {3.796320556780018*^9, 3.796320559097172*^9}, 
   3.796320654025756*^9, {3.796322291309527*^9, 3.796322300154826*^9}, {
   3.796557763169304*^9, 3.79655776411285*^9}, {3.796557804727416*^9, 
   3.796557844423911*^9}, {3.796558050793521*^9, 3.7965581908898287`*^9}, 
   3.796558397846035*^9, {3.796563398441401*^9, 3.7965634189391317`*^9}, {
   3.79656385288803*^9, 3.796563904260149*^9}, 3.796564022316124*^9, {
   3.796634933060278*^9, 3.7966349476405773`*^9}, {3.7966349937518177`*^9, 
   3.7966350041399393`*^9}, 3.796635152689011*^9, {3.796635232657337*^9, 
   3.796635234120371*^9}, {3.796635362892253*^9, 3.796635371059825*^9}, {
   3.796635743403186*^9, 3.7966357601884623`*^9}, {3.796635813897436*^9, 
   3.796635819814723*^9}, 3.796639206817993*^9, {3.7967345464585133`*^9, 
   3.796734611487812*^9}, {3.796734660695097*^9, 3.796734664552396*^9}, {
   3.7968295764383173`*^9, 3.796829683835902*^9}, {3.796829713845192*^9, 
   3.796829858258731*^9}, {3.7968326441445312`*^9, 3.796832666488864*^9}, {
   3.796833059662339*^9, 3.796833067228063*^9}, {3.7968336728050003`*^9, 
   3.796833677282938*^9}, {3.796835133747052*^9, 3.796835134865658*^9}, {
   3.796835167023349*^9, 3.796835195405162*^9}, {3.796835230769445*^9, 
   3.796835253495193*^9}, {3.79698084043729*^9, 3.796980867438106*^9}, {
   3.79776235118194*^9, 
   3.797762368257784*^9}},ExpressionUUID->"77866921-0648-45f4-8a8a-\
2de1985be31f"],

Cell[TextData[{
 StyleBox["This file is available in the Force Field X distribution \
\[OpenCurlyDoubleQuote]mathematica\[CloseCurlyDoubleQuote] directory and on \
GitHub at:\[LineSeparator]https://github.com/SchniedersLab/forcefieldx/blob/\
master/mathematica/ForceFieldX.nb\[LineSeparator]\nForce Field X depends on ",
   "Text",
  FontSize->14,
  FontColor->GrayLevel[0]],
 StyleBox["Java version 21", "Text",
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox[". If your version of Mathematica is using an earlier version, \
please either\[LineSeparator]1) Set the \[OpenCurlyDoubleQuote]JAVA_HOME\
\[CloseCurlyDoubleQuote] environment variable to point to version 21, and \
then start Mathematica from the command line \n", "Text",
  FontSize->14,
  FontColor->GrayLevel[0]],
 StyleBox["or", "Text",
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox[" \[LineSeparator]2) Edit the javacommand string below from \n\
javacommand = \
\[OpenCurlyDoubleQuote]/Library/Java/JavaVirtualMachines/jdk-21.jdk/Contents/\
Home/bin/java \[OpenCurlyDoubleQuote]<>flags; \nto \njavacommand =   ", "Text",
  FontSize->14,
  FontColor->GrayLevel[0]],
 StyleBox["\[OpenCurlyDoubleQuote]/your/path/to/jdk/bin/java \
\[OpenCurlyDoubleQuote]<>flags;\n\nThe first time this notebook is executed, \
FFX will be downloaded to the Mathematica User Base DIrectory for reuse. \nTo \
update FFX, please delete this file and it will be re-downloaded.",
  FontSize->14,
  FontColor->GrayLevel[0]]
}], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796319720247898*^9, 3.7963198883481913`*^9}, {
   3.7963201658100977`*^9, 3.796320195550817*^9}, {3.7963204706720037`*^9, 
   3.796320509099841*^9}, {3.796320556780018*^9, 3.796320559097172*^9}, 
   3.796320654025756*^9, {3.796322291309527*^9, 3.796322300154826*^9}, {
   3.796557763169304*^9, 3.79655776411285*^9}, {3.796557804727416*^9, 
   3.796557844423911*^9}, {3.796558050793521*^9, 3.7965581908898287`*^9}, 
   3.796558397846035*^9, {3.796563398441401*^9, 3.7965634189391317`*^9}, {
   3.79656385288803*^9, 3.796563904260149*^9}, 3.796564022316124*^9, {
   3.796634933060278*^9, 3.7966349476405773`*^9}, {3.7966349937518177`*^9, 
   3.7966350041399393`*^9}, 3.796635152689011*^9, {3.796635232657337*^9, 
   3.796635234120371*^9}, {3.796635362892253*^9, 3.796635371059825*^9}, {
   3.796635743403186*^9, 3.7966357601884623`*^9}, {3.796635813897436*^9, 
   3.796635819814723*^9}, 3.796639206817993*^9, {3.7967345464585133`*^9, 
   3.796734611487812*^9}, {3.796734660695097*^9, 3.796734664552396*^9}, {
   3.7968295764383173`*^9, 3.796829683835902*^9}, {3.796829713845192*^9, 
   3.796829858258731*^9}, {3.7968326441445312`*^9, 3.796832666488864*^9}, {
   3.796833059662339*^9, 3.796833067228063*^9}, {3.7968336728050003`*^9, 
   3.796833677282938*^9}, {3.796835133747052*^9, 3.796835134865658*^9}, {
   3.7968351820758123`*^9, 3.7968351983693857`*^9}, {3.796835369868346*^9, 
   3.796835376437099*^9}, {3.796835546701652*^9, 3.796835600521057*^9}, {
   3.7969782893195047`*^9, 3.7969782898497553`*^9}, {3.79697835641722*^9, 
   3.796978356962029*^9}, {3.796980028189582*^9, 3.7969800330084257`*^9}, {
   3.7969801318492002`*^9, 3.796980290162035*^9}, {3.796980523274188*^9, 
   3.796980583300314*^9}, {3.796980621438861*^9, 3.796980678455365*^9}, {
   3.7969807698075457`*^9, 3.7969808289181356`*^9}, {3.796980878462709*^9, 
   3.796981007555127*^9}, {3.796981785843286*^9, 3.796981798353611*^9}, {
   3.797762374558621*^9, 3.797762387475762*^9}, {3.797762821702941*^9, 
   3.79776282181771*^9}, {3.903646602563777*^9, 3.903646653992766*^9}, {
   3.9036467035179043`*^9, 3.9036467046834383`*^9}, {3.903649414235866*^9, 
   3.903649417718832*^9}, {3.9036494968868856`*^9, 3.903649501067601*^9}, {
   3.905338995124632*^9, 3.905339007184104*^9}, {3.9053391399147167`*^9, 
   3.905339141200696*^9}, {3.905339183651991*^9, 3.905339197117332*^9}, 
   3.905339300185074*^9, {3.905339462658434*^9, 3.905339464459494*^9}, {
   3.905339515500813*^9, 3.905339516637343*^9}, {3.905342271877305*^9, 
   3.905342281760508*^9}, {3.905342326815278*^9, 3.905342361593521*^9}, {
   3.9053424198671703`*^9, 3.9053424867299767`*^9}, {3.9053602900534782`*^9, 
   3.9053603031094723`*^9}, {3.905360532471608*^9, 
   3.905360568744104*^9}},ExpressionUUID->"729dd5db-3fa9-464c-b9f4-\
d41d69407e55"],

Cell[BoxData[{
 RowBox[{"Quit", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<JLink`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ffxVersion", " ", "=", " ", "\"\<1.0.0\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "flags", " ", 
   "=", "\"\<-Dj3d.rend=noop -Djava.awt.headless=true --add-modules \
jdk.incubator.vector\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"javacommand", " ", "=", 
   RowBox[{"\"\</Library/Java/JavaVirtualMachines/jdk-21.jdk/Contents/Home/\
bin/java \>\"", "<>", "flags"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FailureQ", "[", 
      RowBox[{"Environment", "[", "\"\<JAVA_HOME\>\"", "]"}], "]"}], ",", ",", 
     RowBox[{"javacommand", "=", 
      RowBox[{
       RowBox[{"Environment", "[", "\"\<JAVA_HOME\>\"", "]"}], 
       "<>", "\"\</bin/java \>\"", "<>", "flags"}]}]}], "]"}], ";"}],
  FontSize->14,
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"ReinstallJava", "[", 
    RowBox[{
     RowBox[{"CommandLine", "\[Rule]", "javacommand"}], ",", " ", 
     RowBox[{"ClassPath", "\[Rule]", "None"}]}], "]"}], ";"}],
  FontSize->14,
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadJavaClass", "[", 
   RowBox[{"\"\<java.lang.Runtime\>\"", ",", " ", 
    RowBox[{"StaticsVisible", "\[Rule]", "True"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<Java version: \>\"", "<>", 
  RowBox[{
   RowBox[{"version", "[", "]"}], "@", 
   RowBox[{"toString", "[", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "$UserBaseDirectory", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ffxFile", " ", "=", " ", 
   RowBox[{"\"\<ffx-\>\"", "<>", "ffxVersion", 
    "<>", "\"\<-bin.tar.gz\>\""}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "ffxFile", "]"}], ",", 
    RowBox[{"\"\<Using existing Force Field X download: \>\"", "<>", " ", 
     RowBox[{"AbsoluteFileName", "[", "ffxFile", "]"}]}], ",", 
    RowBox[{"ExtractArchive", "[", 
     RowBox[{"URLDownload", "[", 
      RowBox[{
       RowBox[{"\"\<https://ffx.biochem.uiowa.edu/\>\"", "<>", "ffxFile"}], ",",
        " ", 
       RowBox[{"File", "[", "ffxFile", "]"}]}], "]"}], "]"}]}], "]"}],
  FontSize->14,
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ffxLibDir", " ", "=", " ", 
   RowBox[{"\"\<ffx-\>\"", "<>", "ffxVersion", "<>", "\"\</lib\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddToClassPath", "[", " ", 
   RowBox[{
    RowBox[{"AbsoluteFileName", "[", "ffxLibDir", "]"}], ",", " ", 
    RowBox[{"\"\<Prepend\>\"", "\[Rule]", "True"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<Current Directory: \>\"", " ", "<>", 
  RowBox[{"ResetDirectory", "[", "]"}]}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796314172341997*^9, 3.796314173248699*^9}, {
   3.796314545407902*^9, 3.7963145494130087`*^9}, {3.7963145927969103`*^9, 
   3.79631462645579*^9}, {3.79631468583808*^9, 3.796314694341298*^9}, {
   3.79631525177216*^9, 3.796315252467041*^9}, {3.796315604336053*^9, 
   3.796315615089045*^9}, {3.796315762696742*^9, 3.796315772480845*^9}, 
   3.796316090397347*^9, {3.796316378991088*^9, 3.7963164078108177`*^9}, {
   3.796319434041547*^9, 3.7963194368734217`*^9}, {3.7963196850407352`*^9, 
   3.796319702272984*^9}, {3.796319895527026*^9, 3.796319895848812*^9}, {
   3.796557904519747*^9, 3.796558025008265*^9}, {3.796558221600765*^9, 
   3.796558222028757*^9}, {3.796558988607897*^9, 3.7965590216353207`*^9}, {
   3.796559063085082*^9, 3.796559110154477*^9}, {3.796559217976451*^9, 
   3.796559230914063*^9}, {3.7965592837950497`*^9, 3.7965593601154537`*^9}, {
   3.796559398668058*^9, 3.7965594398787537`*^9}, {3.796559481486065*^9, 
   3.796559495522704*^9}, {3.7965595788684483`*^9, 3.796559582376706*^9}, {
   3.796559612509997*^9, 3.796559682013405*^9}, {3.796559723323325*^9, 
   3.7965597282028913`*^9}, {3.796559771678041*^9, 3.796559813323674*^9}, {
   3.796559860574379*^9, 3.7965599711461487`*^9}, 3.79656002060283*^9, {
   3.7965600796967163`*^9, 3.796560087067801*^9}, {3.796560146908255*^9, 
   3.7965601933612003`*^9}, {3.796560223760592*^9, 3.796560228865808*^9}, {
   3.7965603167074137`*^9, 3.7965603617742023`*^9}, {3.7965604145624323`*^9, 
   3.796560490460005*^9}, {3.796560627898026*^9, 3.796560636260198*^9}, {
   3.796560755965912*^9, 3.7965607869953938`*^9}, {3.796560983584619*^9, 
   3.796560996887804*^9}, {3.796561149930429*^9, 3.796561199091805*^9}, {
   3.7965612486653843`*^9, 3.7965612866417933`*^9}, 3.796561321320533*^9, {
   3.796561364520331*^9, 3.796561418563534*^9}, {3.79656165205534*^9, 
   3.796561845288683*^9}, {3.796563339453847*^9, 3.796563363274496*^9}, {
   3.796563423441028*^9, 3.796563424160215*^9}, {3.796638257964097*^9, 
   3.79663826460023*^9}, {3.796638328063662*^9, 3.7966383494509*^9}, {
   3.7966385312590857`*^9, 3.796638562687766*^9}, {3.796638952895308*^9, 
   3.7966389892790327`*^9}, {3.796639043686223*^9, 3.7966391139315147`*^9}, {
   3.7968298608272343`*^9, 3.7968298624666224`*^9}, {3.796833743933317*^9, 
   3.79683374453985*^9}, 3.796835182075972*^9, {3.796978286588044*^9, 
   3.796978309278269*^9}, {3.796978353521957*^9, 3.7969783932290287`*^9}, {
   3.7969784334617367`*^9, 3.7969784426174726`*^9}, {3.7969784927779503`*^9, 
   3.796978563107781*^9}, {3.796978770586092*^9, 3.7969788207843933`*^9}, {
   3.796978853885544*^9, 3.796978881064518*^9}, {3.7969789611011467`*^9, 
   3.796978961576758*^9}, {3.7969790151280518`*^9, 3.796979015684976*^9}, {
   3.796979096674752*^9, 3.7969791025871468`*^9}, {3.796979263890877*^9, 
   3.796979281554274*^9}, {3.796979319062315*^9, 3.7969793412271442`*^9}, {
   3.796979571315137*^9, 3.796979615845694*^9}, {3.7969797961862593`*^9, 
   3.796979858263595*^9}, {3.79697990237043*^9, 3.796980007040873*^9}, {
   3.7969800536602917`*^9, 3.796980114212739*^9}, 3.7969804522154016`*^9, {
   3.796980601804071*^9, 3.796980613519372*^9}, {3.796980726429022*^9, 
   3.796980727102406*^9}, 3.796981054330968*^9, {3.796981125925282*^9, 
   3.7969811892885323`*^9}, {3.796981219372407*^9, 3.7969812986618023`*^9}, {
   3.796981366502334*^9, 3.7969813924222507`*^9}, {3.7969814797257757`*^9, 
   3.796981523916316*^9}, {3.796981629062399*^9, 3.7969816703708677`*^9}, {
   3.7969817172866507`*^9, 3.796981753466632*^9}, 3.7969818234921303`*^9, 
   3.796982989357849*^9, {3.7969830615375013`*^9, 3.796983098663834*^9}, {
   3.797762560256112*^9, 3.797762661168561*^9}, {3.797762738275948*^9, 
   3.7977627644860353`*^9}, {3.9053390830904016`*^9, 3.905339096843597*^9}, {
   3.905339181653613*^9, 3.905339204713315*^9}, {3.905339306554541*^9, 
   3.905339306873982*^9}, {3.905339441899045*^9, 3.905339453239984*^9}, {
   3.9053395254853277`*^9, 3.905339585218132*^9}, {3.905339642701544*^9, 
   3.905339701669907*^9}, {3.905339863984556*^9, 3.905339911072768*^9}, 
   3.905339968225754*^9, {3.9053400193486223`*^9, 3.905340047069253*^9}, {
   3.905340128256154*^9, 3.905340135077114*^9}, {3.905340185018362*^9, 
   3.905340193360313*^9}, {3.905340252492844*^9, 3.905340257443276*^9}, {
   3.905340360111371*^9, 3.905340421475656*^9}, {3.9053405532029676`*^9, 
   3.905340577007454*^9}, {3.905340607504911*^9, 3.905340681970117*^9}, {
   3.905341397763958*^9, 3.905341466812743*^9}, {3.905341735446495*^9, 
   3.905341751408176*^9}, {3.9053420121617613`*^9, 3.905342030329153*^9}, 
   3.905342062857024*^9, 3.90536026754366*^9, {3.905360492662381*^9, 
   3.9053605525747766`*^9}, {3.96996858807582*^9, 3.969968588892867*^9}, {
   3.969968892399457*^9, 3.969968892999634*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"35023ec3-fca6-44c2-99ff-04b9c5c92ed4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["2. Load a Protein Databank File from the RCSB.", \
"Section",
 FontColor->GrayLevel[0]]], "Section",
 CellChangeTimes->{{3.796635176979826*^9, 3.796635240042182*^9}, 
   3.796635340502087*^9, {3.79663568148125*^9, 3.796635682605012*^9}, {
   3.796635714938384*^9, 3.7966357363148823`*^9}, {3.796635839755865*^9, 
   3.796635843934723*^9}, {3.796635928547269*^9, 3.796635973906665*^9}, {
   3.796636042510766*^9, 3.7966360616135683`*^9}, {3.796636311323917*^9, 
   3.796636319652052*^9}, {3.796636413228283*^9, 3.796636414581088*^9}, 
   3.7968353214889383`*^9},ExpressionUUID->"1da4a89c-57d6-4ac1-a439-\
63e90b0a6ff4"],

Cell["\<\
Download a file from the PDB and render it.
a.) Define a string with a 4-character PDB ID. This example uses the \
SARS-CoV-2 main protease.\[LineSeparator]b.) Import the file from the Protein \
Databank, and save it locally.
c.) Display an 2D image of the structure.\
\>", "Text",
 CellChangeTimes->{{3.796635176979826*^9, 3.796635240042182*^9}, 
   3.796635340502087*^9, {3.79663568148125*^9, 3.796635682605012*^9}, {
   3.796635714938384*^9, 3.7966357363148823`*^9}, {3.796635839755865*^9, 
   3.796635843934723*^9}, {3.796635928547269*^9, 3.796635973906665*^9}, {
   3.796636042510766*^9, 3.7966360616135683`*^9}, {3.796636311323917*^9, 
   3.796636319652052*^9}, {3.796636413228283*^9, 3.796636414581088*^9}, 
   3.796835327882111*^9, {3.796835452805217*^9, 
   3.7968354729893627`*^9}},ExpressionUUID->"af1d4f61-2647-4ac5-b15b-\
262202004407"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pdbID", " ", "=", "\"\<1BNA\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"filename", " ", "=", " ", 
  RowBox[{"pdbID", " ", "<>", "\"\<.pdb\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{"URLDownload", "[", 
  RowBox[{
   RowBox[{"\"\<http://www.rcsb.org/pdb/download/downloadFile.do?fileFormat=\
pdb&compression=NO&structureId=\>\"", "<>", "pdbID"}], ",", " ", "filename"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  RowBox[{"filename", ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", " ", "Medium"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7966343921915503`*^9, 3.796634396213505*^9}, {
   3.796634472990549*^9, 3.7966344958322783`*^9}, {3.796634615328989*^9, 
   3.796634693989876*^9}, {3.7966347576011066`*^9, 3.796634871296339*^9}, {
   3.796635402138074*^9, 3.796635446399453*^9}, {3.796635528611723*^9, 
   3.796635546544384*^9}, {3.796635622371907*^9, 3.7966356339591703`*^9}, 
   3.796635665530344*^9, 3.7966359991132298`*^9, {3.796636301833819*^9, 
   3.796636303519103*^9}, {3.796829869601206*^9, 3.796829870204273*^9}, {
   3.796832691579093*^9, 3.79683269227558*^9}, {3.796982863114694*^9, 
   3.796982929683105*^9}, {3.903647339290697*^9, 3.9036473682837963`*^9}, 
   3.9036474363686733`*^9, {3.90364753477055*^9, 3.9036475482435617`*^9}, {
   3.9036476977623453`*^9, 3.903647716471178*^9}, {3.903647764208208*^9, 
   3.903647764642255*^9}, {3.90364787649899*^9, 3.9036479378917513`*^9}, {
   3.90364810012947*^9, 3.903648102050487*^9}, {3.903648172117347*^9, 
   3.903648179063551*^9}, {3.903648325473014*^9, 3.9036483583249617`*^9}, 
   3.9036484300231857`*^9, {3.903648520827668*^9, 3.903648601561661*^9}, {
   3.903648636143364*^9, 3.90364864487643*^9}, {3.903648835642736*^9, 
   3.903648858713566*^9}, {3.9036491655488873`*^9, 3.9036491686780643`*^9}, {
   3.9036492546993523`*^9, 3.903649256339389*^9}, {3.903649288005855*^9, 
   3.903649324484708*^9}, {3.905360326390678*^9, 3.9053603294959917`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"1ddb25ca-80c6-4b0a-8e5c-4edb02f8015c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["3. Use Force Field X Command Line Syntax",
 FontColor->GrayLevel[0]]], "Section",
 CellChangeTimes->{{3.796981910317267*^9, 3.796981970820174*^9}, {
  3.7969832817714233`*^9, 
  3.796983281906084*^9}},ExpressionUUID->"5e5461e3-8d28-4bbb-b876-\
8dd2cc912ac6"],

Cell[TextData[StyleBox["Force Field X command line syntax consists of naming \
a script (e.g. \[OpenCurlyDoubleQuote]Energy\[CloseCurlyDoubleQuote] below) \
and passing an array of String arguments (e.g. filename below).\n\nJLink \
documentation: \t\t\
https://reference.wolfram.com/language/JLink/tutorial/Overview.html\
\[LineSeparator]Force Field X documentation: \t\
https://ffx.biochem.uiowa.edu", "Text",
 FontColor->GrayLevel[0]]], "Text",
 CellChangeTimes->{{3.7969820165871677`*^9, 3.796982039582864*^9}, {
  3.796983299502164*^9, 3.796983362956421*^9}, {3.7969834130066566`*^9, 
  3.796983419722739*^9}},ExpressionUUID->"1edc3151-5855-4f15-ac8e-\
6be403bb355e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LoadJavaClass", "[", 
    RowBox[{"\"\<ffx.Main\>\"", ",", " ", 
     RowBox[{"StaticsVisible", "\[Rule]", "True"}]}], "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Load", " ", "the", " ", "FFX", " ", "Main", " ", "class", " ", "and", " ",
     "its", " ", "static", " ", 
    RowBox[{"methods", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"command", " ", "=", " ", 
    RowBox[{"ffxScript", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<Energy\>\"", ",", "filename"}], "}"}], "]"}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Use", " ", "the", " ", "ffxScript", " ", "static", " ", "method", " ", 
    "to", " ", "run", " ", "the", " ", "Energy", " ", 
    RowBox[{"command", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"forceFieldEnergy", " ", "=", " ", 
    RowBox[{"command", "@", "forceFieldEnergy"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Collect", " ", "a", " ", "reference", " ", "to", " ", "the", " ", 
    "ForceFieldEnergy", " ", "instance", " ", "of", " ", "the", " ", "Energy",
     " ", 
    RowBox[{"commend", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"forceFieldEnergy", "@", 
  RowBox[{"toString", "[", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Log", " ", "the", " ", "result", " ", "for", " ", "each", " ", "energy", " ", 
    RowBox[{"term", "."}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7969820531773643`*^9, 3.79698210017661*^9}, {
  3.7969824697040453`*^9, 3.7969824869613256`*^9}, {3.79698256350874*^9, 
  3.7969825638034363`*^9}, {3.7969826155739193`*^9, 3.796982619961277*^9}, {
  3.796983153318821*^9, 3.796983161664558*^9}, {3.796983232362028*^9, 
  3.796983245950436*^9}, {3.969971117743114*^9, 3.969971221023478*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"fec4361f-ec87-43a0-b2c5-527dc18b2a6f"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["4. Use JLink Syntax to Use the Force Field X ", \
"Section",
 FontColor->GrayLevel[0]]], "Section",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796319977969363*^9, 3.796320142181131*^9}, {
  3.796320201467784*^9, 3.7963202888387337`*^9}, {3.796320614226465*^9, 
  3.796320631501848*^9}, {3.7965581956554327`*^9, 3.796558215755371*^9}, {
  3.796558405404787*^9, 3.796558417381403*^9}, {3.796558495121257*^9, 
  3.796558553696693*^9}, {3.7965634370970383`*^9, 3.7965634602055483`*^9}, {
  3.7965635476429253`*^9, 3.7965636722058363`*^9}, {3.796563718873054*^9, 
  3.796563838373661*^9}, {3.796563921379169*^9, 3.796563944217162*^9}, {
  3.796563974662703*^9, 3.796563998041588*^9}, {3.796634147509673*^9, 
  3.796634147963539*^9}, {3.796635244582906*^9, 3.796635306677973*^9}, {
  3.796636091021267*^9, 3.796636233156569*^9}, {3.796639157265048*^9, 
  3.796639159628797*^9}, {3.796835419897318*^9, 3.796835428612894*^9}, {
  3.796983286001318*^9, 
  3.796983286406315*^9}},ExpressionUUID->"b059f3dc-357a-4d3f-bca7-\
9d9b2f1befd5"],

Cell[TextData[StyleBox["Alternatively, more precise control is possible using \
JLink Syntax to use the entire Force Field X API.\n", "Text",
 FontColor->GrayLevel[0]]], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796319977969363*^9, 3.796320142181131*^9}, {
   3.796320201467784*^9, 3.7963202888387337`*^9}, {3.796320614226465*^9, 
   3.796320631501848*^9}, {3.7965581956554327`*^9, 3.796558215755371*^9}, {
   3.796558405404787*^9, 3.796558417381403*^9}, {3.796558495121257*^9, 
   3.796558553696693*^9}, {3.7965634370970383`*^9, 3.7965634602055483`*^9}, {
   3.7965635476429253`*^9, 3.7965636722058363`*^9}, {3.796563718873054*^9, 
   3.796563838373661*^9}, {3.796563921379169*^9, 3.796563944217162*^9}, {
   3.796563974662703*^9, 3.796563998041588*^9}, {3.796634147509673*^9, 
   3.796634147963539*^9}, {3.796635244582906*^9, 3.796635306677973*^9}, {
   3.796636091021267*^9, 3.796636233156569*^9}, {3.796639157265048*^9, 
   3.796639159628797*^9}, {3.7968354286130323`*^9, 3.7968354312275743`*^9}, 
   3.7969832969050283`*^9, {3.7969833865569353`*^9, 3.796983386986826*^9}, {
   3.796983428025218*^9, 3.796983494132329*^9}, {3.969970688238427*^9, 
   3.9699706904647713`*^9}},ExpressionUUID->"1fa8bbd0-f63a-4b8c-b4f3-\
380be2b96be9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"args", "=", 
    RowBox[{"MakeJavaObject", "[", 
     RowBox[{"{", "filename", "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Create", " ", "an", " ", 
    RowBox[{"String", "[", "]"}], " ", "instance", " ", "with", " ", "one", " ", 
    RowBox[{"entry", "."}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"command", " ", "=", " ", 
    RowBox[{"JavaNew", "[", 
     RowBox[{"\"\<ffx.potential.commands.Energy\>\"", ",", " ", "args"}], 
     "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "an", " ", "instance", " ", "of", " ", "the", " ", "Energy",
     " ", "command", " ", "passing", " ", "in", " ", 
    RowBox[{"arguments", "."}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"command", "@", 
    RowBox[{"run", "[", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Run", " ", "the", " ", 
    RowBox[{"command", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"forceFieldEnergy", " ", "=", " ", 
    RowBox[{"command", "@", "forceFieldEnergy"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Collect", " ", "a", " ", "reference", " ", "to", " ", "the", " ", 
    "ForceFieldEnergy", " ", "instance", " ", "of", " ", "the", " ", "Energy",
     " ", 
    RowBox[{"commend", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"forceFieldEnergy", "@", 
  RowBox[{"toString", "[", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Log", " ", "the", " ", "result", " ", "for", " ", "each", " ", "energy", " ", 
    RowBox[{"term", "."}]}], " ", "*)"}]}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796314995873674*^9, 3.79631500901157*^9}, {
   3.7963151094787617`*^9, 3.796315165143322*^9}, {3.796315238743762*^9, 
   3.796315240563737*^9}, {3.796315397104479*^9, 3.796315504318283*^9}, {
   3.796315588390046*^9, 3.796315593240342*^9}, {3.796315655342431*^9, 
   3.796315656018621*^9}, {3.796316448904894*^9, 3.79631645177849*^9}, {
   3.796318966836712*^9, 3.796318967801186*^9}, {3.796319240494895*^9, 
   3.7963192433902807`*^9}, {3.796319303538065*^9, 3.79631930403563*^9}, {
   3.796319960062272*^9, 3.7963199614550743`*^9}, {3.796320310967033*^9, 
   3.796320311744657*^9}, 3.796320410252369*^9, {3.796322229390833*^9, 
   3.796322246964287*^9}, {3.796558580893156*^9, 3.796558616038336*^9}, {
   3.796558665295681*^9, 3.79655866742901*^9}, {3.7965587487927103`*^9, 
   3.7965589178166523`*^9}, {3.796561887324175*^9, 3.7965619392968903`*^9}, 
   3.796562010403489*^9, {3.7965621748566523`*^9, 3.796562286507094*^9}, {
   3.796562356053624*^9, 3.7965623673048897`*^9}, {3.79656247439052*^9, 
   3.796562493557588*^9}, {3.796562565738244*^9, 3.796562704567507*^9}, {
   3.796562740410612*^9, 3.796562910446607*^9}, {3.7965631010305653`*^9, 
   3.796563130008253*^9}, {3.7965631681590548`*^9, 3.796563310152258*^9}, {
   3.79656346848903*^9, 3.796563524114964*^9}, {3.796563685844124*^9, 
   3.796563710170115*^9}, {3.79663415419769*^9, 3.7966341645438843`*^9}, {
   3.79663489152673*^9, 3.796634892941928*^9}, 3.7968354286131487`*^9, {
   3.969968952475194*^9, 3.9699689663748503`*^9}, {3.969969051809115*^9, 
   3.9699690795607147`*^9}, {3.96996987060268*^9, 3.969969930601756*^9}, {
   3.9699700556522617`*^9, 3.9699700653233967`*^9}, {3.969970096561973*^9, 
   3.96997010270028*^9}, {3.9699701395334377`*^9, 3.9699701537577763`*^9}, {
   3.969970501594455*^9, 3.9699706411023073`*^9}, {3.96997069523811*^9, 
   3.96997071511303*^9}, {3.969970749194058*^9, 3.969970834867937*^9}, {
   3.969970867437833*^9, 3.96997094486659*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"d90c3204-f2a4-466a-856c-8c5836cbcfdc"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1496, 905},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"CloudPublishPath"->"/Published/ForceFieldX.nb"},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"62875f41-0a8c-49bb-b151-a64b69ab774d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1718, 25, 82, "Title",ExpressionUUID->"e93404f3-2eba-4454-ba93-e147654674f6",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2301, 49, 1762, 26, 66, "Section",ExpressionUUID->"77866921-0648-45f4-8a8a-2de1985be31f",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[4066, 77, 4391, 74, 279, "Text",ExpressionUUID->"729dd5db-3fa9-464c-b9f4-d41d69407e55",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[8460, 153, 7870, 140, 335, "Input",ExpressionUUID->"35023ec3-fca6-44c2-99ff-04b9c5c92ed4",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[16367, 298, 642, 10, 66, "Section",ExpressionUUID->"1da4a89c-57d6-4ac1-a439-63e90b0a6ff4"],
Cell[17012, 310, 859, 15, 99, "Text",ExpressionUUID->"af1d4f61-2647-4ac5-b15b-262202004407"],
Cell[17874, 327, 2057, 32, 90, "Input",ExpressionUUID->"1ddb25ca-80c6-4b0a-8e5c-4edb02f8015c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19968, 364, 282, 5, 66, "Section",ExpressionUUID->"5e5461e3-8d28-4bbb-b876-8dd2cc912ac6"],
Cell[20253, 371, 671, 11, 99, "Text",ExpressionUUID->"1edc3151-5855-4f15-ac8e-6be403bb355e"],
Cell[20927, 384, 1919, 44, 90, "Input",ExpressionUUID->"fec4361f-ec87-43a0-b2c5-527dc18b2a6f"],
Cell[CellGroupData[{
Cell[22871, 432, 1085, 17, 66, "Section",ExpressionUUID->"b059f3dc-357a-4d3f-bca7-9d9b2f1befd5",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[23959, 451, 1279, 18, 55, "Text",ExpressionUUID->"1fa8bbd0-f63a-4b8c-b4f3-380be2b96be9",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[25241, 471, 3734, 73, 111, "Input",ExpressionUUID->"d90c3204-f2a4-466a-856c-8c5836cbcfdc",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]]
}, Open  ]]
}
]
*)

